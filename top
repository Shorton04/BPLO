*&---------------------------------------------------------------------*
*& Include          ZIN_CMX_WORKORDER_TOP
*&---------------------------------------------------------------------*

CONSTANTS: c_stat_rel  TYPE jest-stat VALUE 'I0002',   "Released
           c_stat_teco TYPE jest-stat VALUE 'I0045',   "Technically Completed
           c_stat_lkd  TYPE jest-stat VALUE 'I0043',   "Locked
           c_stat_cmxc TYPE jest-stat VALUE 'E0010',   "CMX Confirmed
           c_stat_cmxs TYPE jest-stat VALUE 'E0014'.   "Sent to CMX

TYPES: BEGIN OF ty_output,
         order_msg_status TYPE char10,              "OrderMessageStatus
         werks            TYPE werks_d,             "Plant
         aufnr            TYPE aufnr,               "MaintenanceOrder
         vornr            TYPE vornr,               "MaintenanceOrderOperation
         stat_txt         TYPE char40,              "SystemStatusText
         obj_txt          TYPE char30,              "TechnicalObject
         gstrp            TYPE viaufkst-gstrp,      "Basic Start Date
         gltrp            TYPE viaufkst-gltrp,      "Basic End Date
         lacdate          TYPE viaufkst-lacd_date,  "Latest Acceptable Date
         sysid            TYPE sy-sysid,            "SystemId
         msg              TYPE char72,              "Error Message
       END OF ty_output.

DATA: gt_output TYPE TABLE OF ty_output,
      gs_output TYPE ty_output.

DATA: gt_orders TYPE TABLE OF viaufkst,
      gs_order  TYPE viaufkst.

DATA: gv_atinn TYPE atinn.   "INTERFACE characteristic ID